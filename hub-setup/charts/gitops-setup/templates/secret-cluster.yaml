{{- if $.Values.global.render }}
{{- range $key, $val := $.Values.global.sno }}
---
kind: Secret
apiVersion: v1
metadata:
  name: cluster-api.sno-{{ $key }}. {{ $.Values.global.domain }}.opentlc.com
  namespace:  {{ $.Values.global.namespace }}
  labels:
    argocd.argoproj.io/secret-type: cluster
  {{- if $.Values.global.argocd.enabled }}
  annotations:
    argocd.argoproj.io/sync-wave: "10"
  {{- end }}      
data:
  config: {{ $val.kubeconfig }} # Double check, this is not working
  name: sno-{{ $key }}
  project: project-sno-{{ $key }}
  server: 'https://api.sno-{{ $key }}.{{ $.Values.domain }}.opentlc.com:6443'
type: Opaque
{{- end }}
{{- end }}  